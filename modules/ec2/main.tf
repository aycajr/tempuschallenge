#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#  ,@@@@@@@@.  @@        @@@@@@@@*        @@@@@@@@@@@@,,@@@@
#@  @@@@@@@@  @@@  @@@@@.  @@@@   @@@@@@@@@@@@@@@@@     @@@@
#@&  @@@@@@  &@@@  @@@@@@  @@@  &@@@@@@@@@@@@@@@@@@@@@  @@@@
#@@  ,@@@@. ,@@@@  @@@@@%  @@  ,@@@@@@@@@@@@@@@@@@@@@@  @@@@
#@@@  @@@%  @@@@@        ,@@@  #@@@@@@@@@@@@@@@@@@@@@@  @@@@
#@@@(  @@  @@@@@@  @@@@@@@@@@.  @@@@@@@@@@@@@@@@@@@@@@  @@@@
#@@@@  &* (@@@@@@  @@@@@@@@@@@  .@@@@@@@@@@@@@@@@@@@@@  @@@@
#@@@@@    @@@@@@@  @@@@@@@@@@@@,   %@@@@%,@@@@@@@@@@@@  @@@@
#@@@@@,  @@@@@@@@  @@@@@@@@@@@@@@@(     ,@@@@@@@@@@@@@  @@@@
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
resource "aws_instance" "Bastion_Host1" {
  count                  = 3
  ami                    = "${lookup(var.amis,var.region)}"
  instance_type          = "t2.micro"
  subnet_id              = "${element(var.subnet1_ids,count.index)}"
  vpc_security_group_ids = ["${var.vpc1_bastion_host_sg_id}"]

  tags = [
    {
      Name = "Bastion-Host-${count.index+1}"
    },
    {
      key                 = "Environment"
      value               = "Lab"
      propagate_at_launch = true
    },
    {
      key                 = "Bastion"
      value               = "Host"
      propagate_at_launch = true
    },
  ]
}

#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
#  ,@@@@@@@@.  @@        @@@@@@@@*        @@@@@@@@@&    /@@@
#@  @@@@@@@@  @@@  @@@@@.  @@@@   @@@@@@@@@@@@@@@@ *@@@@   @
#@&  @@@@@@  &@@@  @@@@@@  @@@  &@@@@@@@@@@@@@@@@@@@@@@@@  @
#@@  ,@@@@. ,@@@@  @@@@@%  @@  ,@@@@@@@@@@@@@@@@@@@@@@@@@  @
#@@@  @@@%  @@@@@        ,@@@  #@@@@@@@@@@@@@@@@@@@@@@@&  @@
#@@@(  @@  @@@@@@  @@@@@@@@@@.  @@@@@@@@@@@@@@@@@@@@@@   @@@
#@@@@  &* (@@@@@@  @@@@@@@@@@@  .@@@@@@@@@@@@@@@@@@@   @@@@@
#@@@@@    @@@@@@@  @@@@@@@@@@@@,   %@@@@%,@@@@@@@@  ,@@@@@@@
#@@@@@,  @@@@@@@@  @@@@@@@@@@@@@@@(     ,@@@@@@@@
#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@

resource "aws_instance" "Bastion_Host2" {
  count                  = 3
  ami                    = "${lookup(var.amis,var.region)}"
  instance_type          = "t2.micro"
  subnet_id              = "${element(var.subnet2_ids,count.index)}"
  vpc_security_group_ids = ["${var.vpc2_bastion_host_sg_id}"]

  tags = [
    {
      Name = "Bastion-Host-${count.index+1}"
    },
    {
      key                 = "Environment"
      value               = "Lab"
      propagate_at_launch = true
    },
    {
      key                 = "Bastion"
      value               = "Host"
      propagate_at_launch = true
    },
  ]
}
